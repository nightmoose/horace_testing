// auction.js v2 for SCRUM-5: Enhanced Simple Auction\n// Horace refine: better UX, timer reset on bid, recent bids reversed, end message fix, You as leader\nconst AUCTION_DURATION = 5 * 60 * 1000; // 5 minutes\n\nlet highestBid = 100;\nlet leader = 'Anonymous';\nlet endTime = Date.now() + AUCTION_DURATION;\nlet bids = [{bid: 100, bidder: 'Reserve', time: new Date().toISOString()}];\n\nfunction updateDisplay() {\n  document.getElementById('current-bid').textContent = highestBid.toLocaleString();\n  document.getElementById('leader').textContent = leader;\n\n  const timeLeft = Math.max(0, endTime - Date.now());\n  const mins = Math.floor(timeLeft / 60000);\n  const secs = Math.floor((timeLeft % 60000) / 1000);\n  document.getElementById('time-left').textContent = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n\n  const recentBids = bids.slice(-10).reverse();\n  const list = document.getElementById('history-list');\n  list.innerHTML = recentBids.map(b => \n    `<li>$${b.bid.toLocaleString()} by ${b.bidder} <small>${new Date(b.time).toLocaleTimeString()}</small></li>`\n  ).join('');\n\n  if (timeLeft <= 0) {\n    document.getElementById('bid-form').style.display = 'none';\n    const endMsg = document.getElementById('end-message');\n    endMsg.style.display = 'block';\n    endMsg.textContent = `ðŸŽ‰ Auction Ended! Winner: ${leader} at $${highestBid.toLocaleString()}`;\n  }\n}\n\nfunction placeBid() {\n  const input = document.getElementById('bid-input');\n  const newBid = parseInt(input.value);\n  if (isNaN(newBid) || newBid <= highestBid || (newBid - highestBid) < 5) {\n    alert(`Bid must exceed current $${highestBid} by at least $5! Try $${highestBid + 5} or more.`);\n    return;\n  }\n  highestBid = newBid;\n  leader = 'You';  // Simple: bidder is 'You'\n  const now = Date.now();\n  bids.push({bid: newBid, bidder: leader, time: new Date(now).toISOString()});\n  endTime = now + AUCTION_DURATION;  // Reset timer on new bid for live feel\n  input.value = '';\n  input.placeholder = `Next min: $${highestBid + 5}`;\n  localStorage.setItem('horaceAuction', JSON.stringify({highestBid, leader, endTime, bids}));\n  updateDisplay();\n}\n\ndocument.addEventListener('DOMContentLoaded', function() {\n  const saved = localStorage.getItem('horaceAuction');\n  if (saved) {\n    try {\n      const data = JSON.parse(saved);\n      highestBid = data.highestBid || 100;\n      leader = data.leader || 'Anonymous';\n      endTime = data.endTime || Date.now() + AUCTION_DURATION;\n      bids = data.bids || [{bid: 100, bidder: 'Reserve', time: new Date().toISOString()}];\n    } catch(e) {\n      console.warn('Saved data invalid, reset.');\n    }\n  }\n\n  document.getElementById('bid-btn').addEventListener('click', placeBid);\n  document.getElementById('bid-input').addEventListener('keypress', function(e) {\n    if (e.key === 'Enter') placeBid();\n  });\n\n  // Dynamic min/step\n  document.getElementById('bid-input').min = highestBid + 5;\n\n  updateDisplay();\n  setInterval(updateDisplay, 1000);\n});
